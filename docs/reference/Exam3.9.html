<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Example 3.9 from Generalized Linear Mixed Models: Modern Concepts, Methods and Applications by Walter W. Stroup(p-118) — Exam3.9 • StroupGLMM</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Example 3.9 from Generalized Linear Mixed Models: Modern Concepts, Methods and Applications by Walter W. Stroup(p-118) — Exam3.9" />

<meta property="og:description" content="Exam3.9 used to differentiate conditional and marginal binomial models with and without interaction for S2 variable." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">StroupGLMM</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Example 3.9 from Generalized Linear Mixed Models: Modern Concepts, Methods and Applications by Walter W. Stroup(p-118)</h1>
    
    <div class="hidden name"><code>Exam3.9.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Exam3.9 used to differentiate conditional and marginal binomial models with and without interaction for S2 variable.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <ol>
<li><p>Stroup, W. W. (2012).
     <em>Generalized Linear Mixed Models: Modern Concepts, Methods and Applications</em>.
       CRC Press.</p></li>
</ol>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='DataSet3.2.html'>DataSet3.2</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#-----------------------------------------------------------------------------------</span>
<span class='co'>## Binomial conditional GLMM without interaction, logit link</span>
<span class='co'>#-----------------------------------------------------------------------------------</span>
<span class='fu'>library</span>(<span class='no'>MASS</span>)
<span class='no'>DataSet3.2</span>$<span class='no'>trt</span> <span class='kw'>&lt;-</span> <span class='fu'>factor</span>( <span class='kw'>x</span>  <span class='kw'>=</span>  <span class='no'>DataSet3.2</span>$<span class='no'>trt</span> )
<span class='no'>DataSet3.2</span>$<span class='no'>loc</span> <span class='kw'>&lt;-</span> <span class='fu'>factor</span>( <span class='kw'>x</span>  <span class='kw'>=</span>  <span class='no'>DataSet3.2</span>$<span class='no'>loc</span> )
<span class='no'>Exam3.9.fm1</span>   <span class='kw'>&lt;-</span>
  <span class='fu'><a href='http://www.rdocumentation.org/packages/MASS/topics/glmmPQL'>glmmPQL</a></span>(
      <span class='kw'>fixed</span>    <span class='kw'>=</span>  <span class='no'>S2</span>/<span class='no'>Nbin</span>~<span class='no'>trt</span>
    , <span class='kw'>random</span>   <span class='kw'>=</span> ~<span class='fl'>1</span><span class='kw'>|</span><span class='no'>loc</span>
    , <span class='kw'>family</span>   <span class='kw'>=</span>  <span class='fu'>quasibinomial</span>(<span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>)
    , <span class='kw'>data</span>     <span class='kw'>=</span>  <span class='no'>DataSet3.2</span>
  <span class='co'># , weights</span>
  <span class='co'># , control</span>
    , <span class='kw'>niter</span>    <span class='kw'>=</span> <span class='fl'>10</span>
    , <span class='kw'>verbose</span>  <span class='kw'>=</span> <span class='fl'>TRUE</span>
    <span class='co'># , ...</span>
  )</div><div class='output co'>#&gt; <span class='message'>iteration 1</span></div><div class='output co'>#&gt; <span class='message'>iteration 2</span></div><div class='output co'>#&gt; <span class='message'>iteration 3</span></div><div class='output co'>#&gt; <span class='message'>iteration 4</span></div><div class='input'><span class='fu'>summary</span>(<span class='no'>Exam3.9.fm1</span>)</div><div class='output co'>#&gt; Linear mixed-effects model fit by maximum likelihood
#&gt;  Data: DataSet3.2 
#&gt;   AIC BIC logLik
#&gt;    NA  NA     NA
#&gt; 
#&gt; Random effects:
#&gt;  Formula: ~1 | loc
#&gt;         (Intercept) Residual
#&gt; StdDev:   0.7710488  0.33184
#&gt; 
#&gt; Variance function:
#&gt;  Structure: fixed weights
#&gt;  Formula: ~invwt 
#&gt; Fixed effects: S2/Nbin ~ trt 
#&gt;                  Value Std.Error DF   t-value p-value
#&gt; (Intercept) -1.7997839 0.4591969 21 -3.919416  0.0008
#&gt; trt1         0.2823215 0.4752384 21  0.594063  0.5588
#&gt; trt2         0.8788371 0.4502862 21  1.951730  0.0644
#&gt; trt3         1.0548226 0.4461060 21  2.364511  0.0278
#&gt;  Correlation: 
#&gt;      (Intr) trt1   trt2  
#&gt; trt1 -0.561              
#&gt; trt2 -0.596  0.571       
#&gt; trt3 -0.603  0.576  0.610
#&gt; 
#&gt; Standardized Within-Group Residuals:
#&gt;        Min         Q1        Med         Q3        Max 
#&gt; -2.0036140 -0.5699977 -0.2243692  0.4913423  2.4790311 
#&gt; 
#&gt; Number of Observations: 32
#&gt; Number of Groups: 8 </div><div class='input'>
<span class='co'>#-------------------------------------------------------------</span>
<span class='co'>##  treatment means</span>
<span class='co'>#-------------------------------------------------------------</span>
<span class='fu'>library</span>(<span class='no'>lsmeans</span>)
(<span class='no'>Lsm3.9fm1</span>   <span class='kw'>&lt;-</span>
  <span class='kw pkg'>lsmeans</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/lsmeans/topics/lsmeans'>lsmeans</a></span>(
      <span class='kw'>object</span>  <span class='kw'>=</span> <span class='no'>Exam3.9.fm1</span>
    , <span class='kw'>specs</span>   <span class='kw'>=</span> <span class='st'>"trt"</span>
    , <span class='kw'>link</span><span class='kw'>=</span><span class='fl'>TRUE</span>
    <span class='co'># , ...</span>
  )
)</div><div class='output co'>#&gt;  trt     lsmean        SE df  lower.CL    upper.CL
#&gt;  0   -1.7997839 0.4591969  7 -2.885612 -0.71395572
#&gt;  1   -1.5174624 0.4381757  7 -2.553583 -0.48134141
#&gt;  2   -0.9209468 0.4088300  7 -1.887676  0.04578253
#&gt;  3   -0.7449613 0.4033992  7 -1.698849  0.20892630
#&gt; 
#&gt; Results are given on the logit (not the response) scale. 
#&gt; Confidence level used: 0.95 </div><div class='input'><span class='co'>##--- Normal Approximation</span>
<span class='fu'>library</span>(<span class='no'>nlme</span>)
<span class='no'>Exam3.9fm2</span> <span class='kw'>&lt;-</span>
  <span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/lme'>lme</a></span>(
      <span class='kw'>fixed</span>       <span class='kw'>=</span> <span class='no'>S2</span>/<span class='no'>Nbin</span>~<span class='no'>trt</span>
    , <span class='kw'>data</span>        <span class='kw'>=</span> <span class='no'>DataSet3.2</span>
    , <span class='kw'>random</span>      <span class='kw'>=</span> ~<span class='fl'>1</span><span class='kw'>|</span><span class='no'>loc</span>
    , <span class='kw'>weights</span>     <span class='kw'>=</span> <span class='kw'>NULL</span>
  <span class='co'># , subset</span>
    , <span class='kw'>method</span>      <span class='kw'>=</span> <span class='st'>"REML"</span> <span class='co'>#c("REML", "ML")</span>
    , <span class='kw'>na.action</span>   <span class='kw'>=</span> <span class='no'>na.fail</span>
  <span class='co'># , control     = list()</span>
    , <span class='kw'>contrasts</span>   <span class='kw'>=</span> <span class='kw'>NULL</span>
    , <span class='kw'>keep.data</span>   <span class='kw'>=</span> <span class='fl'>TRUE</span>
  )
(<span class='no'>Lsm3.9fm2</span>    <span class='kw'>&lt;-</span>
  <span class='kw pkg'>lsmeans</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/lsmeans/topics/lsmeans'>lsmeans</a></span>(
      <span class='kw'>object</span>  <span class='kw'>=</span> <span class='no'>Exam3.9fm2</span>
    , <span class='kw'>specs</span>   <span class='kw'>=</span> <span class='st'>"trt"</span>
    <span class='co'># , ...</span>
  )
)</div><div class='output co'>#&gt;  trt    lsmean         SE df    lower.CL  upper.CL
#&gt;  0   0.1604167 0.07277836  7 -0.01167680 0.3325101
#&gt;  1   0.2000000 0.07277836  7  0.02790654 0.3720935
#&gt;  2   0.3041667 0.07277836  7  0.13207320 0.4762601
#&gt;  3   0.3395833 0.07277836  7  0.16748987 0.5116768
#&gt; 
#&gt; Confidence level used: 0.95 </div><div class='input'>
<span class='co'>##---Binomial GLMM with interaction</span>
<span class='no'>Exam3.9fm3</span>   <span class='kw'>&lt;-</span>
  <span class='fu'><a href='http://www.rdocumentation.org/packages/MASS/topics/glmmPQL'>glmmPQL</a></span>(
      <span class='kw'>fixed</span>       <span class='kw'>=</span>  <span class='no'>S2</span>/<span class='no'>Nbin</span>~<span class='no'>trt</span>
    , <span class='kw'>random</span>      <span class='kw'>=</span> ~<span class='fl'>1</span><span class='kw'>|</span><span class='no'>trt</span>/<span class='no'>loc</span>
    , <span class='kw'>family</span>      <span class='kw'>=</span>  <span class='fu'>quasibinomial</span>(<span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>)
    , <span class='kw'>data</span>        <span class='kw'>=</span>  <span class='no'>DataSet3.2</span>
  <span class='co'># , weights</span>
  <span class='co'># , control</span>
    , <span class='kw'>niter</span> <span class='kw'>=</span> <span class='fl'>10</span>
    , <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
    <span class='co'># , ...</span>
  )</div><div class='output co'>#&gt; <span class='message'>iteration 1</span></div><div class='output co'>#&gt; <span class='message'>iteration 2</span></div><div class='output co'>#&gt; <span class='message'>iteration 3</span></div><div class='output co'>#&gt; <span class='message'>iteration 4</span></div><div class='output co'>#&gt; <span class='message'>iteration 5</span></div><div class='output co'>#&gt; <span class='message'>iteration 6</span></div><div class='output co'>#&gt; <span class='message'>iteration 7</span></div><div class='output co'>#&gt; <span class='message'>iteration 8</span></div><div class='output co'>#&gt; <span class='message'>iteration 9</span></div><div class='output co'>#&gt; <span class='message'>iteration 10</span></div><div class='input'><span class='fu'><a href='http://www.rdocumentation.org/packages/lsmeans/topics/summary'>summary</a></span>(<span class='no'>Exam3.9fm3</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; Linear mixed-effects model fit by maximum likelihood
#&gt;  Data: DataSet3.2 
#&gt;   AIC BIC logLik
#&gt;    NA  NA     NA
#&gt; 
#&gt; Random effects:
#&gt;  Formula: ~1 | trt
#&gt;          (Intercept)
#&gt; StdDev: 1.768771e-05
#&gt; 
#&gt;  Formula: ~1 | loc %in% trt
#&gt;          (Intercept)  Residual
#&gt; StdDev: 2.946519e-06 0.4265118
#&gt; 
#&gt; Variance function:
#&gt;  Structure: fixed weights
#&gt;  Formula: ~invwt 
#&gt; Fixed effects: S2/Nbin ~ trt 
#&gt;                  Value Std.Error DF   t-value p-value
#&gt; (Intercept) -1.4485522 0.4379601 28 -3.307498  0.0026
#&gt; trt1         0.2349559 0.5998313  0  0.391703     NaN
#&gt; trt2         0.6971934 0.5791864  0  1.203746     NaN
#&gt; trt3         0.7330440 0.5794759  0  1.265012     NaN
#&gt;  Correlation: 
#&gt;      (Intr) trt1   trt2  
#&gt; trt1 -0.730              
#&gt; trt2 -0.756  0.552       
#&gt; trt3 -0.756  0.552  0.571
#&gt; 
#&gt; Standardized Within-Group Residuals:
#&gt;        Min         Q1        Med         Q3        Max 
#&gt; -1.8229824 -0.8793369 -0.4149872  0.5574551  2.2264946 
#&gt; 
#&gt; Number of Observations: 32
#&gt; Number of Groups: 
#&gt;          trt loc %in% trt 
#&gt;            4           32 </div><div class='input'>(<span class='no'>Lsm3.9fm3</span>    <span class='kw'>&lt;-</span>
  <span class='kw pkg'>lsmeans</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/lsmeans/topics/lsmeans'>lsmeans</a></span>(
      <span class='kw'>object</span>  <span class='kw'>=</span> <span class='no'>Exam3.9fm3</span>
    , <span class='kw'>specs</span>   <span class='kw'>=</span> <span class='st'>"trt"</span>
  <span class='co'># , ...</span>
  )
)</div><div class='output co'>#&gt;  trt     lsmean        SE df  lower.CL    upper.CL
#&gt;  0   -1.4485522 0.4379601  3 -2.842337 -0.05476769
#&gt;  1   -1.2135963 0.4098640  0 -2.517966  0.09077395
#&gt;  2   -0.7513588 0.3790090  0 -1.957535  0.45481710
#&gt;  3   -0.7155082 0.3794512  0 -1.923091  0.49207499
#&gt; 
#&gt; Results are given on the logit (not the response) scale. 
#&gt; Confidence level used: 0.95 </div><div class='input'>
<span class='co'>##---Binomial Marginal GLMM(assuming compound symmetry)</span>
<span class='no'>Exam3.9fm4</span>   <span class='kw'>&lt;-</span>
  <span class='fu'><a href='http://www.rdocumentation.org/packages/MASS/topics/glmmPQL'>glmmPQL</a></span>(
      <span class='kw'>fixed</span>       <span class='kw'>=</span>  <span class='no'>S2</span>/<span class='no'>Nbin</span>~<span class='no'>trt</span>
    , <span class='kw'>random</span>      <span class='kw'>=</span> ~<span class='fl'>1</span><span class='kw'>|</span><span class='no'>loc</span>
    , <span class='kw'>family</span>      <span class='kw'>=</span>  <span class='fu'>quasibinomial</span>(<span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>)
    , <span class='kw'>data</span>        <span class='kw'>=</span>  <span class='no'>DataSet3.2</span>
    , <span class='kw'>correlation</span> <span class='kw'>=</span>  <span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/corCompSymm'>corCompSymm</a></span>(<span class='kw'>form</span><span class='kw'>=</span>~<span class='fl'>1</span><span class='kw'>|</span><span class='no'>loc</span>)
  <span class='co'># , weights</span>
  <span class='co'># , control</span>
    , <span class='kw'>niter</span>       <span class='kw'>=</span> <span class='fl'>10</span>
    , <span class='kw'>verbose</span>     <span class='kw'>=</span> <span class='fl'>TRUE</span>
  <span class='co'># , ...</span>
  )</div><div class='output co'>#&gt; <span class='message'>iteration 1</span></div><div class='input'><span class='fu'><a href='http://www.rdocumentation.org/packages/lsmeans/topics/summary'>summary</a></span>(<span class='no'>Exam3.9fm4</span>)</div><div class='output co'>#&gt; Linear mixed-effects model fit by maximum likelihood
#&gt;  Data: DataSet3.2 
#&gt;   AIC BIC logLik
#&gt;    NA  NA     NA
#&gt; 
#&gt; Random effects:
#&gt;  Formula: ~1 | loc
#&gt;         (Intercept)  Residual
#&gt; StdDev:  0.00074658 0.4412173
#&gt; 
#&gt; Correlation Structure: Compound symmetry
#&gt;  Formula: ~1 | loc 
#&gt;  Parameter estimate(s):
#&gt;       Rho 
#&gt; 0.3817415 
#&gt; Variance function:
#&gt;  Structure: fixed weights
#&gt;  Formula: ~invwt 
#&gt; Fixed effects: S2/Nbin ~ trt 
#&gt;                  Value Std.Error DF   t-value p-value
#&gt; (Intercept) -1.6551311 0.4544041 21 -3.642421  0.0015
#&gt; trt1         0.2688368 0.4854471 21  0.553792  0.5856
#&gt; trt2         0.8275968 0.4605683 21  1.796903  0.0867
#&gt; trt3         0.9899796 0.4564203 21  2.169008  0.0417
#&gt;  Correlation: 
#&gt;      (Intr) trt1   trt2  
#&gt; trt1 -0.608              
#&gt; trt2 -0.686  0.577       
#&gt; trt3 -0.701  0.583  0.624
#&gt; 
#&gt; Standardized Within-Group Residuals:
#&gt;        Min         Q1        Med         Q3        Max 
#&gt; -1.6252165 -0.6846589 -0.3489664  0.6677812  2.6023420 
#&gt; 
#&gt; Number of Observations: 32
#&gt; Number of Groups: 8 </div><div class='input'>(<span class='no'>Lsm3.9fm4</span>  <span class='kw'>&lt;-</span>
  <span class='kw pkg'>lsmeans</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/lsmeans/topics/lsmeans'>lsmeans</a></span>(
      <span class='kw'>object</span>  <span class='kw'>=</span> <span class='no'>Exam3.9fm4</span>
    , <span class='kw'>specs</span>   <span class='kw'>=</span> <span class='st'>"trt"</span>
    <span class='co'># , ...</span>
  )
)</div><div class='output co'>#&gt;  trt     lsmean        SE df  lower.CL    upper.CL
#&gt;  0   -1.6551311 0.4544041  7 -2.729626 -0.58063610
#&gt;  1   -1.3862944 0.4169109  7 -2.372132 -0.40045667
#&gt;  2   -0.8275344 0.3624894  7 -1.684685  0.02961675
#&gt;  3   -0.6651516 0.3521450  7 -1.497842  0.16753898
#&gt; 
#&gt; Results are given on the logit (not the response) scale. 
#&gt; Confidence level used: 0.95 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
<ol>
<li><p>Muhammad Yaseen (<a href='mailto:myaseen208@gmail.com'>myaseen208@gmail.com</a>)</p></li>
<li><p>Adeela Munawar (<a href='mailto:adeela.uaf@gmail.com'>adeela.uaf@gmail.com</a>)</p></li>
</ol>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Muhammad Yaseen, Adeela Munawar.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

